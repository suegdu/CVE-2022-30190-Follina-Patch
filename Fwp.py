import os
import sys
def worker():
    os.system("reg delete HKEY_CLASSES_ROOT\ms-msdt /f")
    print("Successfully Patched.")
    input("Press Enter To Exit....")
def workerinput():
    input1 = input("Do you want to back up the registry key? [N/Y]:> ").lower()
    if input1=="y":
        try:
         print("working....")
         os.system("reg export HKEY_CLASSES_ROOT\ms-msdt ""C:\FWP Registry Key Backup\\""")
         print("Successfully Exported.")
         try:
             worker()
         except:
             print("Error: Something went wrong during the Patch process.")
             input("Press Enter To Exit.")
        except:
            print("Error: Something went wrong during the export process.")
            input("Press Enter To Exit.")
            sys.exit()
    elif input1=="n":
        print("working....")
        worker()
    elif input1=="":
        workerinput()
    elif input1==" ":
        workerinput()
def main():
    os.system("title FWP")
    print(__file__)
    print()
    print("Workarounds To disable the MSDT URL Protocol Disabling MSDT URL protocol prevents troubleshooters being launched \nas links including links throughout the operating system. Troubleshooters can still be accessed using the \nGet Help application and in system settings as other or additional troubleshooters\n. \nThis is just a simple program to patch it temporarily. \n\nFor more information visit: https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/")
    print()
    print()
    input("Press Enter To Start The Procedure....")
    workerinput() 
    
  
if __name__ == '__main__':
 main()
